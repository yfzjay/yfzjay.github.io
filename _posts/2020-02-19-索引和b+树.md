---
layout: post
title: 'b+/b/红黑树->索引和文件系统'
date: 2020-02-19
author: yza
color: rgb(255,210,32)
cover: '../assets/bigdata.jpg'
tags: 数据结构和算法 Mysql
typora-copy-images-to: ..\assets\image
---

## 文件系统索引为什么不用二叉查找树或者说红黑树？

### 一、面试被怼

面试官：你知道文件索引、数据库索引一般用什么数据结构来存储吗？

小秋：知道啊，一般都是用**树形结构**来存储的。

面试官：可以说说为啥用树形结构来存储吗？

小秋：树形结构例如想 B 树，B+ 树，二叉查找树都是有序的，所以查询效率很高，可以再 O(logn) 的时间复杂度查找到目标数据。

面试官：那可以问问文件索引，例如数据库索引一般用哪种树形结构吗？

小秋：大部分用 B+ 树，少部分用 B 树。（B和B+树太他么复杂了，幸好背了下面试题，嘻嘻）

面试官：想问下为什么要用 B 树而不用二叉查找树啊？或者为啥不用哈希表啊？哈希表的查找速度也很快呀。

小秋：哈希表虽然能够再 O(1) 查找到目标数据，不过如果我们要进行**模糊查找**的话，却只能遍历所有数据，并且如果出现了极端情况，哈希表冲突的元素太多，也会导致线性时间的查找效率的。

面试官：那为啥不用二叉查找树呢？

小秋：这个…..其实我也不知道，当时是在某个面试题中看到的答案的，嘻嘻。

面试官：那你可以回去等通知了….

### 二、为啥不用二叉查找树呢？

小秋被怼后有点沮丧，跑过来问帅地关于 B 树的一些知识以及心中的疑问。

小秋：今天去面试，面试问我，为啥文件索引要用 B 树而不用二叉查找树，然后我想了下，感觉如果这是一颗比较平衡的二叉查找树的话，那么查找效率是非常快的，难度 B 树还能比它更快吗？

帅地：确实，如果是查找效率（即比较次数）的话，实际上二叉树可以说是最快的了，但是，我们的文件索引是存放在**磁盘**上的，所以我们不仅要考虑查找效率，还要考虑**磁盘的寻址加载次数**哦，而这也是我们为什么要用 B 树的原因。

小秋：难道二叉查找树会导致磁盘的加载次数更多吗？可以给我详细讲讲吗？

帅地：可以呀，不过听懂了，觉得我讲的不错，你要记得给我**多点赞，转发**哦。

小秋：绝对没问题。

### 三、什么是 B 树？

帅地：要讲懂这个问题，我们先来了解一下什么是 B 树，其实，B 树和二叉查找树一样，都是**树**，**B 树**相当于是一棵**多叉查找树**，对于一棵 m 阶的 B 树具有如下特性：

1、根节点至少有两个孩子。

2、每个中间节点都包含 k – 1 个元素和 k 个孩子，其中 m/2 <= k <= m。

3、每一个叶子节点都包含 k – 1 个元素，其中 m/2 <= k <= m。

4、所有的叶子节点都位于同一侧。

5、每个节点中的元素从小到大排列，节点当中的 k – 1 个元素正好是 k 个孩子包含的元素的值域划分。

小秋：我去，这么复杂，鬼才记得住，我还是选择不学了，呜呜。

帅地：你别着急，这些规则我也记不住，只是让你大致知道一些这些规则，一般情况下，我们并不需要把它的规则完全背起来滴。为了加深理解，我给你举个 B 树的例子吧。例如：

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543433-43819028da268e9.jpg)

图中是一棵m = 3 的 3 阶 B 树，可以看出，树中有些节点是有**多个元素**的，并且和二叉查找树一样，左节点的所有元素的值都比父亲元素小。例如对于(3, 7)这个节点。两个元素把这个节点分割成**三个值域**，即可以有 3 个孩子。2 相当于 3 的左孩子节点，而 （4，6）相当于 3 的右孩子，同时也是 7 的左孩子，而 9 是 7 的右孩子。

和二叉查找树还是很相似滴，都是有序，且左孩子小，右孩子大，只是 B 树的一个节点可以有**多个元素**，并且有多个分支。而这些分支以及元素的数量规则，可以从上面的五个规则中查找哈。说实话，我也懒的记那些规则，只知道个大概以及 B 树的应用即可。

> 文章来源于微信公众：『苦逼的码农』，更多文章可搜索关注

### 四、小秋的疑惑

小秋：我知道了，不过这种多叉的树，真的可以比二叉查找树效率更好吗，我怎么觉得不可以呢？

帅地：那你可以说说哦。

小秋：例如，上面的 B 树有 11 个元素，按照这 11 个元素，我们建立一个如下的二叉查找树，如图（我去，这个图片了好长时间，ppt 画的）

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543434-eb931c609d706c7.jpg)

**下面我们来进行查询效率比较**

**1、在 B 树中的查找次数**。
现在假如我们要查询元素 9,对于 B 树，我们需要进行**4次比较**，例如：
第一次比较：10 比较，比 10 小，所以再 10 的左孩子找。

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543434-05e8e280dad479e.jpg)

第二、三次比较：和 3 比较，比 3 大，这个时候我们还得和 7 比较。

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543434-185135889274863.jpg)

第四次比较：和 9 比较，相等，找到目标树，返回。

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543434-062c0452d8bf32c.jpg)

所以最终的结果需要 4 次比较。

**2、在二叉树的比较结果**

为了节省篇幅，我就不逐个比较了，相信你也一眼就看出来了，也是需要 4 次比较。如图

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543435-3abb9c134e5c471.jpg)

小秋：同样都是四次比较，而且，B 树的每一个节点，如果存放的元素比较多，那么 B 树的比较次数会更多，为什么就说 B 的效率比 二叉查找树快呢？

### 五、解决疑惑

帅地：确实，如果单单从比较次数看的话，二叉查找树确实不比 B 树差，不过你忽略了一个很重要的点，那就是**磁盘的寻址加载次数**。

我们知道，在把磁盘里的数据加载到内存中的时候，是以**页**为单位来加载的，而我们也知道，**节点与节点之间的数据是不连续的**，所以不同的节点，很有可能分布在不同的**磁盘页**中。所以对于上面的二叉查找树，我们可能需要进行 4 次寻址加载，如图：

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543435-c35343f4358126e.jpg)

而对于 B 树，由于 B 树的每一个节点，可以存放多个元素，树比二叉搜索树矮，所以磁盘寻址加载的次数会比较少，例如上面的例子中，用 B 树的话，只需要加载 3 次，如图：

![高频面试题：什么是B树？为啥文件索引要用B树而不用二叉查找树？]({{site.baseurl}}/assets/image/1571543436-3b0194e4be9420b.jpg)

**我们都知道，在内存的运算速度是非常快的，至少比磁盘的寻址加载速度，快了几百倍，而我们进行数值比较的时候，是在内存中进行的，虽然 B 树的比较次数可能比二叉查找树多，但是磁盘操作次数少，所以总体来说，还是 B 树快的多，这也是为什么我们用使用 B 树来存储的原因。**

小秋：原来这样啊，以前一直蒙在鼓里。

> 文章来源于微信公众：『苦逼的码农』，更多文章可搜索关注

帅地：不知道你发现没有，实际上磁盘的加载次数，基本上是和树的**高度**相关联的，高度越高，加载次数越多，越矮，加载次数越少。所以对于这种文件索引的存储，我们一般会选择**矮胖**的树形结构。例如有 1000 个元素，如果是二叉查找树的话，高度可能高达 10 层,而如果用 10 阶 B 树的话，只需要三四层即可。

小秋：终于搞懂了，不过我还有个疑问，大部分文件索引或者数据库索引都是用 B+ 树的，而只有小部分才用 B 树，可以问下为什要用 B+ 树而不用 B 树吗？还有，B 树还有其他的应用吗？

帅地：B 树除了会用在少部分的文件索引（数据库索引）外，应用的最多的就是**文件系统**了。至于为什么要用 B 树而不用 B+ 树，为什么数据库索引大部分用 B+ 树而不用 B 树，我们下节再讲了。

小秋：那我期待着。

帅地：如果觉得有收获，可以帮忙多多转发，点赞，分享哦，这也是我写文章的动力来源。

### 总结

关于 B 树和 B+ 树，在面试的过程中，还是问的挺多滴，特别是问到数据库的时候，基本会问索引，进而问到 B+ 树，从而也会扯到 B 树。所以掌握着两种树的应用以及原理，是非常重要的，虽然他们的规则很复杂，但是如果是应付面试等，其实不需要背那些规则，只需要知道大概以及知道他们的原理即可。

## 为什么不用尽可能多路的b树使加载次数最小化呢？

## 大多数数据库索引为什么用b+树而不是b树?

## 为什么数据库索引不用查找速度更快的hash存储？

**【面试现场】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359278-fd40c4ca7d98fd7.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359278-bf888a0a1324f6c.jpeg)

小史：没问题，这个项目前端用的react+webpack，后端用的nginx+SpringBoot+Redis+MySql，前后端分离的，最后用docker进行容器化部署。主要模块有师生系统、课程系统、成绩系统、选课系统等。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359278-37f45a4704c7a27.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359279-e37e9b3e98da796.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359279-a9c90cbace7350b.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359279-85c8c4736b324e6.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359279-26036eaa91575eb.jpeg)

这个项目的架构和说辞，小史早已背得溜溜的。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359280-6f71723d1d8598a.jpeg)

小史：底层mysql是存储，redis是缓存，dao层操作mysql，cache层操作redis，service层处理业务逻辑，rest api层为前端提供rest接口。前端这边用react进行模块化，webpack打包部署。网关nginx进行负载均衡。mysql、redis、nginx和springboot应用都放在docker里部署。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359280-7b41a9125610f87.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359280-00bb45c681a9819.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359280-025d289855dbce4.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359281-401ac838fae6bd6.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359281-5007d8a47bbbd2f.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359281-401ac838fae6bd6-1.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359282-1f12b4ae501c96c.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359282-8f45a63a24b53e4.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359282-8f45a63a24b53e4-1.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359283-49c293e872c6927.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359283-bb7d804def26c30.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359283-a0602e1e6f5ad42.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359283-360b0cc415a43d5.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359283-bb7d804def26c30-1.jpeg)

**题目：****为什么MySQL数据库要用B+树存储索引？**

小史听到这个题目，陷入了回忆。

**【前段时间的饭局】**

话说吕老师给小史讲完[人工智能的一些知识](http://mp.weixin.qq.com/s?__biz=MzIzMTE1ODkyNQ==&mid=2649410733&idx=1&sn=9df27d1d07a70a6e13256934caf2a20d&chksm=f0b6094fc7c18059fb9f19b62377cf8bba347f3ee5f7dac9d2afa5e08c18f576bcab4315dc0d&scene=21#wechat_redirect)后，他们一起回家吃小史姐姐做的饭去了。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359284-7b9fe4b4fbd7898.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359284-d3d83e31555c20e.jpeg)

**【饭后】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359284-7b9fe4b4fbd7898-1.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359284-99d7de21781e918.jpeg)

吕老师：面试的时候一定是往深了问，不精通的话容易吃亏。不过面试时一般都是根据项目来问，项目中用到的技术，一定要多看看原理，特别是能和数据结构和算法挂钩的那部分。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359285-033e522b852068f.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359285-bae8064a6767003.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359285-c1cb9d2a60af07f.jpeg)

小史：树的话，无非就是前中后序遍历、二叉树、二叉搜索树、平衡二叉树，更高级一点的有红黑树、B树、B+树，还有之前你教我的字典树。

**【红黑树】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359286-76c61c86b41f8c8.jpeg)

一听到红黑树，小史头都大了，开始抱怨了起来。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359286-471985105feebc8.jpeg)

小史：红黑树看过很多遍了，但是每次都记不住，它的规则实在是太多了，光定义就有四五条规则，还有插入删除的时候，需要调整树，复杂得很。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359286-806f11c934204f2.jpeg)

吕老师：小史，问你红黑树，并不是让你背诵它的定义，或者让你手写一个红黑树，而是想问问你它为什么这样设计，它的使用场景有哪些。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359287-12105c478ade88b.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359287-75a20d8e0636951.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359287-396d3bfcb59f3af.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359287-ffba8c05e1d28cd.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359288-b2c8840c2903bf2.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359288-b075f4e7287a706.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359288-4fbcabdb7d351cc.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359288-531905ba56c72a3.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359289-d1d90d65b932253.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359289-1d6d91790f25868.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359289-b104333ad638533.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359289-86592891db73df6.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359289-9b1d550268c6074.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359290-2b19da17bf0a32b.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359290-66f8a68c5184b45.jpeg)

**【B树】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359290-416482ad2d1ae57.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359291-b57945c3e572333.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359291-44054342af81540.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359291-feef5a78ca5cdfe.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359292-5e215ab1fa04dc2.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359292-7226a0df5561dfc.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359292-5b53c49f7dd758f.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359292-fc1be9ddcf90948.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359292-ae948fb48b0b60d.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359293-3a474c8e3e64a77.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359293-effbdf1db864262.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359293-f6ac92bee23f43f.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359293-755a390e6b360d2.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359294-64717d596661612.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359294-a54ca5658ff8027.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359294-18b1958131f480b.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359295-ff1d16d9fad4a52.jpeg)

吕老师：小史，你要知道，文件系统和数据库的索引都是存在硬盘上的，并且如果数据量大的话，不一定能一次性加载到内存中。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359295-a30ebf69d502171.jpeg)

两个月前，小史面试没考虑内存情况差点挂了，[传送门](http://mp.weixin.qq.com/s?__biz=MzIzMTE1ODkyNQ==&mid=2649410393&idx=1&sn=e2aae1e16baede316922c53256a10c5f&chksm=f0b60ebbc7c187ad4e48b140daff2c80e5007076e99b26427fef50dd7f19ffed5181ba45baed&scene=21#wechat_redirect)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359295-b0d3b70a45396f2.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359295-06c3e57348e5b66.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359295-347c827afd59452.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359296-fea761ac504c6b1.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359296-e046c41640ca252.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359296-3c5a8c85cb327a1.jpeg)

**【B+树】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359296-f170856ea6aa419.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359297-661b2d5db5f171e.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359297-094063fbb535cde.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359297-dfe430271fa0ccb.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359297-418b3930c4cf717.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359297-b1003b3e3d34d7c.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359298-5de30d170c15693.jpeg)

吕老师：这也是和业务场景相关的，你想想，数据库中select数据，不一定只选一条，很多时候会选多条，比如按照id排序后选10条。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359298-db48e3ba3616cf7.jpeg)

小史：我明白了，如果是多条的话，B树需要做局部的中序遍历，可能要跨层访问。而B+树由于所有数据都在叶子结点，不用跨层，同时由于有链表结构，只需要找到首尾，通过链表就能把所有数据取出来了。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359298-9a9b9d9d66f2c75.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359298-37948446d726807.jpeg)

**【回到现场】**

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359299-277a465e6e89b99.jpeg)

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359299-0e8a7bf8993b4ec.jpeg)

小史：这和业务场景有关。如果只选一个数据，那确实是hash更快。但是数据库中经常会选择多条，这时候由于B+树索引有序，并且又有链表相连，它的查询效率比hash就快很多了。

![【面试现场】为什么 MySQL 数据库要用B+树存储索引？]({{site.baseurl}}/assets/image/1571359299-0e8a7bf8993b4ec-1.jpeg)

小史：而且数据库中的索引一般是在磁盘上，数据量大的情况可能无法一次装入内存，B+树的设计可以允许数据分批加载，同时树的高度较低，提高查找效率。

#### 总结：

**数据库索引为什么不用b树？**

**和3一样，当范围查找时，b树需要做局部的中序遍历，甚至有可能跨层遍历，而对于b+树来说，只需要定位到叶子结点起始位置即可。**

**关于mysql索引问题更全的：**

[mysql索引简介]({{site.baseurl}}/2020/04/01/Mysql索引简介.html)

#### 转自：https://www.cxyxiaowu.com/

### 感谢！！！
2020219
### 